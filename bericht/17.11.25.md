# Vulnerability Scanning

**Name**: Jan Freitag   
**Klasse**: 4AHITS   
**Fach**: ITSE   
**Datum**: 17.11.2025   
**Anweisungen**: [Vulnerability Scanning](https://www.franzmatejka.at/htl/doc/ITSI_4/lab/04_vulnscan.html)

## Übungen

###### Windows

```shell
┌──(parallels㉿kali-linux-2024-2)-[~]
└─$ nmap 172.20.10.5
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-07 18:14 CET
Nmap scan report for 172.20.10.5
Host is up (0.00030s latency).
Not shown: 997 closed tcp ports (reset)
PORT    STATE SERVICE
135/tcp open  msrpc
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
MAC Address: 00:1C:42:71:DD:9E (Parallels)

Nmap done: 1 IP address (1 host up) scanned in 1.37 seconds
```

###### Default Gateway

```shell
┌──(parallels㉿kali-linux-2024-2)-[~]
└─$ nmap 172.20.10.1       
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-07 18:17 CET
Nmap scan report for 172.20.10.1
Host is up (0.0083s latency).
Not shown: 996 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
53/tcp    open  domain
49152/tcp open  unknown
62078/tcp open  iphone-sync
MAC Address: A6:F6:E8:F4:28:64 (Unknown)
```

##### Was kann alles mit einem port scan herausgefunden werden? Dokumentiere!

- up / down
- PORT, STATE, SERVICE
- MAC

### nmap cheat sheet

[Cheat Sheet](nmap Cheat sheet.md)

### Optionen

```shell
nmap -Pn -sS -sV -sC -oN nmap_default.txt <ip>
```

- **`-Pn`** - Überspringt Host Discovery (behandelt Host als online)
- **`-sS`** - TCP SYN Scan (Half-Open Scan)
- **`-sV`** - Service/Version Detection
- **`-sC`** - Führt Standard-Script-Scan aus
- **`-oN nmap_default.txt`** - Speichert Ergebnis in normale Text-Datei

[nmap Ausgabe](nmap Ausgabe.md)

#### Aufgabe 1

```shell
nmap -sC -F <ip>
```

nmap Ausgabe 2

#### Aufgabe 2

```shell
nmap --script banner.nse 172.20.10.2         
nmap --script http-title.nse 172.20.10.2     
nmap --script dns-brute.nse 172.20.10.2                                                                     
nmap --script targets-sniffer.nse 172.20.10.2
nmap --script ftp-anon.nse 172.20.10.2       
```

nmap Ausgabe 3

#### Aufgabe 3

```shell
┌──(parallels㉿kali-linux-2024-2)-[/usr/share/nmap/scripts]
└─$ nmap --script vulners.nse 172.20.10.2
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-07 18:48 CET
Nmap scan report for 172.20.10.2
Host is up (0.00100s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 52:54:00:12:34:56 (QEMU virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.33 seconds

```

### very safe FTP backdoor

```shell
┌──(parallels㉿kali-linux-2024-2)-[~]
└─$ nmap --script=vuln -p 21 172.20.10.2
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-07 18:56 CET
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Nmap scan report for 172.20.10.2
Host is up (0.00078s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|       https://www.securityfocus.com/bid/48539
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
MAC Address: 52:54:00:12:34:56 (QEMU virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 35.93 seconds
```

